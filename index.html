<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="utf-8">
<title>Index</title>

<style>
body{
  background:#000;
  color:#e0e0e0;
  font-family:monospace
}
h1{color:#6cf}
a{color:#9cf;text-decoration:none}
a:hover{text-decoration:underline}
ul{margin-bottom:30px}
#viewer{
  max-width:900px;
  margin-top:40px;
  line-height:1.5
}

/* ================================
   RP9 – Metallisk matematikstil
   ================================ */

/* Inline-matematik – silver */
.math.inline,
mjx-inline{
  color:#c0c0c0 !important;
  text-shadow:
    0 0 4px rgba(192,192,192,0.35),
    0 0 10px rgba(255,255,255,0.25);
  font-weight:500;
}

/* Block-matematik – guld */
.math.block,
mjx-container[jax="CHTML"][display="true"]{
  color:#d4af37 !important;
  text-shadow:
    0 0 6px rgba(212,175,55,0.4),
    0 0 14px rgba(255,215,0,0.3);
  font-weight:500;
}
</style>

<!-- Markdown -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<!-- MathJax -->
<script>
window.MathJax={
  tex:{
    inlineMath:[['$','$']],
    displayMath:[['$$','$$']]
  },
  options:{
    renderActions:{
      addClasses:[
        200,
        function(doc){
          doc.math.forEach(function(m){
            m.typesetRoot.classList.add(
              m.display ? "math block" : "math inline"
            );
          });
        },
        ""
      ]
    }
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

</head>
<body>

<h1>Index</h1>
<ul id="file-list"></ul>

<h1>Filtyper som renderas</h1>
<ul>
<li>.html</li>
<li>.md</li>
<li>.markdown</li>
<li>.txt</li>
<li>.pdf</li>
<li>.png</li>
<li>.jpg</li>
<li>.jpeg</li>
<li>.gif</li>
<li>.svg</li>
<li>.zip</li>
<li>.csv</li>
<li>.json</li>
<li>.xml</li>
</ul>

<div id="viewer"></div>

<script>
const owner="AntonWallin999";
const repo="3";
const branch="main";

const allowedExtensions=[
  ".html",".md",".markdown",".txt",".pdf",
  ".png",".jpg",".jpeg",".gif",".svg",
  ".zip",".csv",".json",".xml"
];

fetch("https://api.github.com/repos/"+owner+"/"+repo+"/contents?ref="+branch)
.then(function(response){
  return response.json();
})
.then(function(files){
  const list=document.getElementById("file-list");

  files.forEach(function(file){
    if(file.type!=="file") return;

    const name=file.name.toLowerCase();
    const allowed=allowedExtensions.some(function(ext){
      return name.endsWith(ext);
    });
    if(!allowed) return;

    const li=document.createElement("li");
    const a=document.createElement("a");
    a.textContent=file.name;

    /* Markdown → viewer */
    if(name.endsWith(".md") || name.endsWith(".markdown")){
      a.href="#";
      a.onclick=function(){
        fetch(file.name)
        .then(function(r){return r.text();})
        .then(function(t){
          document.getElementById("viewer").innerHTML=marked.parse(t);
          MathJax.typesetPromise();
        });
        return false;
      };
    }
    /* Övriga filer → direktlänk */
    else{
      a.href=file.name;
      a.target="_blank";
    }

    li.appendChild(a);
    list.appendChild(li);
  });
});
</script>

</body>
</html>
